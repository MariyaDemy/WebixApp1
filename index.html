<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Webix First App</title>
    <script
      type="text/javascript"
      src="http://cdn.webix.com/edge/webix.js"
    ></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="http://cdn.webix.com/edge/webix.css"
    />
    <script type="text/javascript" src="./testdata.js"></script>
    <style type="text/css">
      .webix_template {
        text-align: center;
      }
      .webix_list {
        background-color: rgb(233, 233, 236);
      }
      .greenLabel .webix_el_box {
        color: #138137;
        text-align: center;
        background-color: rgb(233, 233, 236);
      }
      .header {
        background-color: rgb(6 35 53 / 54%);
      }
      .webix_secondary .webix_button .webix_icon_btn {
        color: #fff;
      }
      .myBtn .webix_button,
      .myBtn .webix_button:hover,
      .myBtn .webix_button:focus,
      .myBtn .webix_button:active {
        color: #fff;
        background-color: inherit;
      }
      .myLabel .webix_el_box {
        color: #fff;
        font-size: 18px;
      }
    </style>
  </head>
  <body>
    <div id="my_link" style="display: none">
      The software is provided by
      <a href="https://webix.com" target="_blank">https://webix.com</a>. All
      rights reserved (c)
    </div>

    <script type="text/javascript" charset="utf-8">
      let header = {
        padding: 10,
        css: "header",
        cols: [
          { view: "label", label: "My App", css: "myLabel" },
          {
            view: "button",
            id: "profile",
            type: "icon",
            icon: "wxi-user",
            label: "Profile",
            maxWidth: 100,
            css: "myBtn",
            click: function () {
              if (!$$("popup").isVisible()) {
                $$("popup").show($$("profile").getNode(), {
                  pos: "bottom",
                  x: 0,
                  y: 5,
                });
              }
            },
          },
        ],
      };

      let list = {
        view: "list",
        scroll: false,
        maxWidth: 200,
        data: ["Dashboard", "Users", "Products", "Locations"],
      };

      let label = {
        view: "label",
        label: "<span class='webix_icon wxi-check'></span> Connected",
        css: "greenLabel",
      };

      let datatable = {
        view: "datatable",
        id: "mydata",
        scrollX: false,
        scrollY: true,
        data: small_film_set,
        autoConfig: true,
      };

      let today = new Date();

      let form = {
        view: "form",
        id: "myform",
        maxWidth: 300,
        elements: [
          { type: "section", template: "Edit Films" },
          {
            view: "text",
            label: "Title",
            height: 50,
            name: "title",
            invalidMessage: "Enter a title",
          },
          {
            view: "text",
            type: "number",
            label: "Year",
            height: 50,
            name: "year",
            invalidMessage: "Enter a year between 1970 and current",
          },
          {
            view: "text",
            type: "number",
            label: "Rating",
            height: 50,
            name: "rating",
            invalidMessage: "Enter a number except 0",
          },
          {
            view: "text",
            type: "number",
            label: "Votes",
            height: 50,
            name: "votes",
            invalidMessage: "Enter a number less than 100000",
          },
          {
            margin: 15,
            cols: [
              {
                view: "button",
                value: "Add new",
                css: "webix_primary",
                click: function () {
                  const form = $$("myform");
                  if (form.validate()) {
                    let values = form.getValues();
                    $$("mydata").add(values);
                    webix.message("The form is completed properly");
                  }
                },
              },
              {
                view: "button",
                value: "Clear",
                click: function () {
                  webix
                    .confirm({
                      title: "Form will be cleared",
                      text: "Do you still want to continue?",
                    })
                    .then(function () {
                      const form = $$("myform");
                      form.clear();
                      form.clearValidation();
                    });
                },
              },
            ],
          },
          { view: "spacer" },
        ],
        rules: {
          title: webix.rules.isNotEmpty,
          year: function (value) {
            return value >= 1970 && value <= today.getFullYear();
          },
          rating: function (value) {
            return value != 0 && webix.rules.isNotEmpty(value);
          },
          votes: function (value) {
            return value < 100000;
          },
        },
      };

      let main = {
        cols: [{ rows: [list, label] }, { view: "resizer" }, datatable, form],
      };

      let footer = {
        rows: [{ view: "template", template: "html->my_link", height: 30 }],
      };

      webix.ui({
        view: "popup",
        id: "popup",
        body: {
          view: "list",
          data: ["Settings", "Log Out"],
          scroll: false,
          autoheight: true,
        },
      });

      webix.ui({
        rows: [header, main, footer],
      });
    </script>
  </body>
</html>
